@page "/GamesList"

@using MiniatureGolf.Models
@using MiniatureGolf.Services

@inherits MiniatureGolf.Pages.GamesListModel

<h1>Games</h1>

<div style="position: relative;">
    <div class="c-flexContainer">
        <TelerikButton Class="c-flexItem c-flexItemFirst" @OnClick="@(() => { this.SelectedDateFilter = DateFilter.Day; this.LoadGames(); })">day</TelerikButton>
        <TelerikButton Class="c-flexItem" @OnClick="@(() => { this.SelectedDateFilter = DateFilter.Week; this.LoadGames(); })">week</TelerikButton>
        <TelerikButton Class="c-flexItem" @OnClick="@(() => { this.SelectedDateFilter = DateFilter.Month; this.LoadGames(); })">month</TelerikButton>
        <TelerikButton Class="c-flexItem" @OnClick="@(() => { this.SelectedDateFilter = DateFilter.Quarter; this.LoadGames(); })">quarter</TelerikButton>
        <TelerikButton Class="c-flexItem c-flexItemLast" @OnClick="@(() => { this.SelectedDateFilter = DateFilter.Year; this.LoadGames(); })">year</TelerikButton>
    </div>

    <div>
        <TelerikDropDownList Data="@this.FilterStates" @bind-value="@this.SelectedFilterStateId" ValueField="@nameof(FilterState.Id)" TextField="@nameof(FilterState.Name)" Height="38px" Width="110px" PopupHeight="Auto" TItem="@FilterState" TValue="@int" />
        <TelerikTextBox Label="search for player" @bind-value="@this.PlayerFilterInput" />
    </div>

    <div style="margin-top: 10px; min-height: 235px; height: calc(100vh - 250px);">
        <TelerikGrid Data=@this.CurrentGames Height="100%" Sortable="true">
            <TelerikGridColumns>
                <TelerikGridColumn Title="Status" Editable="false" Width="130px" Field="@nameof(LightweightGamestate.Status)">
                    <Template>
                        @if (context is LightweightGamestate gs)
                        {
                            <a class="btn @(this.GetButtonClassForState(gs))" href="@($"/MiniatureGolf/{gs.Game.GUID}/{(int)UserMode.SpectatorReadOnly}/0")" role="button" style="width: 100%;">@(gs.StatusText)</a>
                        }
                    </Template>
                </TelerikGridColumn>

                <TelerikGridColumn Title="Time" Editable="false" Width="190px" Field="@nameof(LightweightGamestate.Time)" />

                <TelerikGridColumn Title="Players" Editable="false" Field="@nameof(LightweightGamestate.PlayersText)" />
            </TelerikGridColumns>
        </TelerikGrid>
    </div>

    <div class="c-disableOverlay" data-lockPointer="@(this.IsGridBusyIndicatorOpactyAnimationTrigger ? "true" : "false")" style="visibility: @(this.IsGridBusyIndicatorVisible ? "visible" : "collapse");">
        <div class="c-disableOverlayOuterContainer">
            <div class="c-disableOverlayContainer" style="opacity: @(this.IsGridBusyIndicatorOpactyAnimationTrigger ? "1" : "0");">
                <div style="font-size: 60px;" class="c-animate-flicker">⏱</div>
                <div style="font-size: 1.5em; text-align: center;">loading...</div>
            </div>
        </div>
    </div>
</div>

<link href="/css/styles/GamesList.min.css" rel="stylesheet" />
                    